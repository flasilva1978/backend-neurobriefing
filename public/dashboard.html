<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard NeuroBriefing | Diagn√≥stico Integral</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* ==========================================================================
           1. ESTILOS GERAIS E RESET
           ========================================================================== */
        
        * { 
            box-sizing: border-box; 
            -webkit-print-color-adjust: exact; /* For√ßa impress√£o de cores de fundo */
        }
        
        body { 
            font-family: 'Montserrat', sans-serif; 
            background: #f0f2f5; 
            margin: 0; 
            padding: 20px; 
            color: #333; 
        }
        
        /* ==========================================================================
           2. ESTILOS DO PAINEL (VIS√ÉO TELA)
           ========================================================================== */
        
        .painel { 
            max-width: 1200px; 
            margin: 0 auto 30px auto; 
            background: white; 
            padding: 25px; 
            border-radius: 10px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); 
        }
        
        .header-painel { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 2px solid #f0f0f0; 
            padding-bottom: 20px; 
            margin-bottom: 20px; 
        }
        
        .hp-title { 
            font-size: 18pt; 
            font-weight: 800; 
            color: #2c3e50; 
        }
        
        .btn-refresh { 
            background: #2c3e50; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            cursor: pointer; 
            border-radius: 6px; 
            font-weight: 700; 
            font-size: 9pt; 
            transition: 0.2s; 
        }
        
        .btn-refresh:hover { 
            background: #34495e; 
        }
        
        /* TABELA DE CLIENTES */
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        
        th { 
            text-align: left; 
            padding: 15px 10px; 
            background: #f8f9fa; 
            color: #7f8c8d; 
            font-weight: 700; 
            font-size: 8pt; 
            text-transform: uppercase; 
            border-bottom: 2px solid #eee; 
        }
        
        td { 
            padding: 15px 10px; 
            border-bottom: 1px solid #eee; 
            vertical-align: top; 
            font-size: 9.5pt; 
        }
        
        tr:hover { 
            background-color: #fafafa; 
        }
        
        .cli-name { 
            font-size: 11pt; 
            font-weight: 700; 
            color: #2c3e50; 
            display: block; 
            margin-bottom: 4px; 
        }
        
        .cli-local { 
            font-size: 8pt; 
            color: #999; 
            display: block; 
            margin-bottom: 8px; 
        }
        
        /* STATUS TAGS */
        .mod-grid { 
            display: flex; 
            gap: 4px; 
            flex-wrap: wrap; 
        }
        
        .mod-tag { 
            padding: 3px 6px; 
            border-radius: 4px; 
            font-size: 7pt; 
            font-weight: 700; 
            text-transform: uppercase; 
            background: #eee; 
            color: #bbb; 
            border: 1px solid #e0e0e0; 
        }
        
        .mod-tag.done { 
            background: #e8f5e9; 
            color: #27ae60; 
            border-color: #c8e6c9; 
        }
        
        .btn-pdf { 
            background: #e74c3c; 
            color: white; 
            border: none; 
            padding: 8px 16px; 
            border-radius: 4px; 
            font-weight: 700; 
            font-size: 8pt; 
            cursor: pointer; 
        }
        
        .btn-pdf:hover { background: #c0392b; }
        .btn-pdf:disabled { background: #ccc; cursor: not-allowed; }

        /* ==========================================================================
           3. ESTILOS DO RELAT√ìRIO PDF (FOLHA A4)
           ========================================================================== */
        
        #pdf-root { display: none; } 
        
        .page { 
            width: 210mm; 
            height: 296mm; 
            background: white; 
            position: relative; 
            overflow: hidden; 
            margin: 0 auto; 
            page-break-after: always; 
            padding: 0; 
        }
        .page:last-child { page-break-after: avoid; }
        
        /* CAPA */
        .capa-box { 
            width: 100%; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            border: 20mm solid #f4f6f8; 
            text-align: center; 
        }
        
        .c-logo { font-size: 38pt; font-weight: 900; color: #2c3e50; margin-bottom: 10px; letter-spacing: -1px; }
        .c-sub { font-size: 10pt; letter-spacing: 4px; text-transform: uppercase; color: #7f8c8d; margin-bottom: 80px; }
        
        .c-info { 
            width: 80%; 
            border-top: 2px solid #2c3e50; 
            border-bottom: 2px solid #2c3e50; 
            padding: 40px 0; 
            margin-bottom: 50px; 
        }
        
        .ci-lbl { font-size: 8pt; font-weight: 700; color: #aaa; text-transform: uppercase; margin-bottom: 5px; display: block; letter-spacing: 1px; }
        .ci-val { font-size: 16pt; font-weight: 700; color: #2c3e50; margin-bottom: 25px; display: block; }
        .c-foot { position: absolute; bottom: 15mm; font-size: 8pt; color: #ccc; text-transform: uppercase; }
        
        /* HEADER DO MODULO */
        .mod-content { 
            padding: 15mm 15mm 10mm 15mm; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
        }
        
        .m-head { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-end; 
            border-bottom: 4px solid #2c3e50; 
            padding-bottom: 10px; 
            margin-bottom: 20px; 
        }
        
        .mh-tit { font-size: 22pt; font-weight: 800; color: #2c3e50; line-height: 1; }
        .mh-sub { font-size: 9pt; font-weight: 600; color: #7f8c8d; text-transform: uppercase; margin-top: 5px; }
        .mh-meta { text-align: right; }
        .mh-num { font-size: 30pt; font-weight: 900; color: #eee; line-height: 0.8; }
        .mh-time { font-size: 8pt; font-weight: 700; color: #e74c3c; margin-top: 5px; display: block; }
        
        /* BOXES DE CONTE√öDO */
        .win-box { 
            border: 1px solid #ccc; 
            border-radius: 6px; 
            overflow: hidden; 
            margin-bottom: 15px; 
            display: flex; 
            flex-direction: column; 
        }
        
        .wb-head { padding: 10px 15px; color: white; display: flex; justify-content: space-between; align-items: center; }
        .wb-tit { font-size: 14pt; font-weight: 800; text-transform: uppercase; }
        .wb-sty { font-size: 8pt; font-weight: 600; opacity: 0.95; text-transform: uppercase; }
        .wb-body { padding: 20px; flex: 1; }
        
        /* GRIDS ESTRAT√âGICOS (M√ìDULO 1) */
        .strategy-grid { display: flex; gap: 15px; margin-bottom: 15px; }
        .st-card { flex: 1; background: #fdfdfd; border: 1px solid #eee; border-radius: 6px; padding: 15px; display: flex; flex-direction: column; }
        .st-card.highlight { border-left: 4px solid #3498db; background: #fbfdff; }
        .st-card.shadow-card { border-left: 4px solid #f1c40f; background: #fffcf5; }
        
        .st-head { 
            font-size: 9pt; font-weight: 800; color: #2c3e50; text-transform: uppercase; 
            margin-bottom: 8px; padding-bottom: 5px; border-bottom: 2px solid #eee; 
        }
        .st-text { font-size: 8.5pt; color: #555; line-height: 1.5; text-align: justify; }

        /* GR√ÅFICOS DE BARRAS (MOD 1) */
        .charts { display: flex; gap: 10px; margin-bottom: 15px; height: 40px; }
        .cc-box { flex: 1; border: 1px solid #eee; border-radius: 4px; padding: 5px 8px; background: #fafafa; display: flex; flex-direction: column; justify-content: space-between; }
        .cc-top { display: flex; justify-content: space-between; align-items: center; }
        .cc-lbl { font-size: 8pt; font-weight: 800; text-transform: uppercase; }
        .cc-val { font-size: 11pt; font-weight: 900; }
        .cc-bar { width: 100%; height: 5px; background: #ddd; border-radius: 3px; overflow: hidden; }
        .cc-fill { height: 100%; }

        /* BOX DE CONCLUS√ÉO T√âCNICA (RODAP√â) */
        .box-conclusao { 
            background: #fdfdfd; 
            border-left: 4px solid #2c3e50; 
            padding: 15px; 
            font-size: 9pt; color: #555; line-height: 1.5; 
            margin-top: auto; 
            margin-bottom: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); 
        }
        .bc-tit { font-weight: 800; color: #2c3e50; text-transform: uppercase; margin-bottom: 8px; font-size: 10pt; display: block; }
        
        /* GRIDS & LISTAS (GERAL) */
        .grid-2 { display: flex; gap: 20px; }
        .col { flex: 1; }
        .info-row { margin-bottom: 8px; border-bottom: 1px dashed #eee; padding-bottom: 4px; }
        .il { font-size: 7pt; font-weight: 700; color: #999; text-transform: uppercase; display: block; margin-bottom: 2px; }
        .iv { font-size: 10pt; font-weight: 600; color: #333; line-height: 1.25; }
        .item-list { margin-bottom: 8px; border-bottom: 1px dashed #eee; padding-bottom: 8px; }
        .il-lbl { font-size: 8pt; font-weight: 700; color: #2c3e50; text-transform: uppercase; display: block; margin-bottom: 3px; }
        .il-val { font-size: 9pt; color: #555; }
        
        /* --- ESTILOS DO M√ìDULO 3 (SENSORIAL - 8 CARDS) --- */
        .sensory-grid-8 { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            grid-template-rows: repeat(4, auto); 
            gap: 15px; 
            margin-bottom: 20px; 
        }
        
        .sense-card { 
            background: #fff; 
            border: 1px solid #eee; 
            border-radius: 6px; 
            padding: 12px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
            display: flex; flex-direction: column;
        }
        
        .sense-head { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 8px; border-bottom: 1px solid #f0f0f0; padding-bottom: 5px; 
        }
        .sense-title { font-size: 9pt; font-weight: 800; color: #2c3e50; text-transform: uppercase; display: flex; align-items: center; gap: 6px; }
        .sense-icon { font-size: 12pt; }
        
        .sense-bar-container { display: flex; align-items: center; margin-bottom: 8px; }
        .sense-bar-bg { flex: 1; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; }
        .sense-bar-fill { height: 100%; border-radius: 3px; transition: width 0.3s; }
        .sense-val { font-size: 8pt; font-weight: 700; width: 30px; text-align: right; margin-left: 8px; }
        
        .sense-strategy { 
            font-size: 8pt; color: #555; font-style: italic; line-height: 1.4; 
            background: #fdfdfd; padding: 6px; border-radius: 4px; border-left: 3px solid #ddd; 
        }

        /* --- BARRAS SIMPLES (OUTROS M√ìDULOS) --- */
        .sensory-bar { display: flex; align-items: center; margin-bottom: 8px; }
        .sb-lbl { width: 100px; font-size: 8pt; font-weight: 700; text-align: right; margin-right: 10px; }
        .sb-track { flex: 1; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; }
        .sb-fill { height: 100%; background: #2c3e50; }
        .sb-val { width: 30px; font-size: 8pt; font-weight: 700; margin-left: 10px; }

        /* --- TAGS DE CHECKLIST (MOD 5) --- */
        .check-tags { display: flex; flex-wrap: wrap; gap: 5px; }
        .ct-item { background: #f0f2f5; padding: 5px 10px; border-radius: 4px; font-size: 8.5pt; font-weight: 600; color: #555; border: 1px solid #ddd; }
        .ct-item.highlight { background: #e8f5e9; color: #27ae60; border-color: #c8e6c9; }

        /* --- CORES UTILIT√ÅRIAS --- */
        .c-fogo { color: #e74c3c; } .bg-fogo { background: #e74c3c; }
        .c-ar { color: #3498db; } .bg-ar { background: #3498db; }
        .c-agua { color: #2980b9; } .bg-agua { background: #2980b9; }
        .c-terra { color: #27ae60; } .bg-terra { background: #27ae60; }
        
        /* Cores Sensoriais (Mod 3) */
        .s-vis { color: #f39c12; } .bg-vis { background: #f39c12; border-color: #f39c12; }
        .s-aud { color: #9b59b6; } .bg-aud { background: #9b59b6; border-color: #9b59b6; }
        .s-olf { color: #27ae60; } .bg-olf { background: #27ae60; border-color: #27ae60; }
        .s-tat { color: #e67e22; } .bg-tat { background: #e67e22; border-color: #e67e22; }
        .s-prop { color: #c0392b; } .bg-prop { background: #c0392b; border-color: #c0392b; }
        .s-gus { color: #e84393; } .bg-gus { background: #e84393; border-color: #e84393; }
        .s-emo { color: #8e44ad; } .bg-emo { background: #8e44ad; border-color: #8e44ad; }
        .s-cog { color: #2980b9; } .bg-cog { background: #2980b9; border-color: #2980b9; }

        .ft-note { text-align: center; font-size: 6pt; color: #bbb; padding-top: 5px; }
    </style>
</head>
<body>

    <div class="painel">
        <div class="header-painel">
            <div class="hp-title">Dashboard NeuroBriefing</div>
            <button class="btn-refresh" onclick="location.reload()">üîÑ Atualizar Dados</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th style="width: 100px;">Data</th>
                    <th style="width: 30%;">Cliente</th>
                    <th style="width: 20%;">Respons√°vel</th>
                    <th>Status</th>
                    <th style="text-align:right;">A√ß√£o</th>
                </tr>
            </thead>
            <tbody id="lista"><tr><td colspan="5">Carregando dados...</td></tr></tbody>
        </table>
    </div>

    <div id="pdf-root">
        
        <div class="page">
            <div class="capa-box">
                <div class="c-logo">NEUROBRIEFING</div>
                <div class="c-sub">Diagn√≥stico Integral & Estrat√©gia</div>
                <div class="c-info">
                    <span class="ci-lbl">Cliente Analisado</span><span class="ci-val" id="cp-nome">-</span>
                    <span class="ci-lbl">Arquiteto Respons√°vel</span><span class="ci-val" id="cp-arq">-</span>
                    <span class="ci-lbl">Data do Diagn√≥stico</span><span class="ci-val" id="cp-data">-</span>
                </div>
                <div class="c-foot">Documento Confidencial de Uso Profissional</div>
            </div>
        </div>

        <div class="page">
            <div class="mod-content">
                <div class="m-head">
                    <div><div class="mh-tit">IDENTIDADE DO SER</div><div class="mh-sub">Arqu√©tipo & Temperamento</div></div>
                    <div class="mh-meta"><div class="mh-num">01</div><span class="mh-time" id="t1-time">--:--</span></div>
                </div>
                
                <div class="charts" id="chart-container"></div>
                
                <div class="win-box">
                    <div class="wb-head" id="wb-head"><div class="wb-tit" id="txt-el">-</div><div class="wb-sty" id="txt-tit">-</div></div>
                    <div class="wb-body" id="m1-content"></div>
                </div>

                <div class="strategy-grid">
                    <div class="st-card">
                        <div class="st-head">üß† NEUROARQUITETURA (BASE)</div>
                        <div class="st-text" id="m1-neuro-individual"></div>
                    </div>
                    <div class="st-card">
                        <div class="st-head">üó£Ô∏è ATENDIMENTO (BASE)</div>
                        <div class="st-text" id="m1-comunicacao-individual"></div>
                    </div>
                </div>

                <div class="strategy-grid">
                    <div class="st-card highlight">
                        <div class="st-head">üëë PERFIL COMBINADO (DOMINANTE + SECUND√ÅRIO)</div>
                        <div class="st-text" id="m1-perfil-texto"></div>
                        <div class="st-text" id="m1-projeto-texto" style="margin-top:8px; font-weight:bold;"></div>
                    </div>
                    <div class="st-card shadow-card">
                        <div class="st-head">‚ö†Ô∏è PONTO DE ATEN√á√ÉO (SOMBRA)</div>
                        <div class="st-text" id="m1-sombra-texto"></div>
                        <div class="st-text" id="m1-comunicacao-texto" style="margin-top:8px; font-style:italic;"></div>
                    </div>
                </div>

                <div class="box-conclusao">
                    <span class="bc-tit">DIRETRIZ PROJETUAL (M√ìDULO 1)</span>
                    O perfil identificado exige uma estrat√©gia de design que respeite a "Energia Base". 
                    A neuroarquitetura sugere alinhar a complexidade visual ao n√≠vel de est√≠mulo que este c√©rebro suporta (Dopamina vs Ocitocina), equilibrando o temperamento dominante com o secund√°rio e compensando a sombra.
                </div>
                <div class="ft-note">NeuroBriefing Intelligence</div>
            </div>
        </div>

        <div class="page">
            <div class="mod-content">
                <div class="m-head">
                    <div><div class="mh-tit">IDENTIDADE VISUAL</div><div class="mh-sub">Estilo & Prefer√™ncia Est√©tica</div></div>
                    <div class="mh-meta"><div class="mh-num">02</div><span class="mh-time" id="t2-time">--:--</span></div>
                </div>
                
                <div class="win-box" style="flex:0 auto; margin-bottom:20px;">
                    <div class="wb-head" style="background:#2c3e50;">
                        <div class="wb-tit">ESTILO PREDOMINANTE</div>
                        <div class="wb-sty" style="color:#f1c40f;">MATCH PRINCIPAL</div>
                    </div>
                    <div class="wb-body" style="padding:20px; text-align:center;">
                        <h2 style="margin:0; font-size:24pt; color:#2c3e50; text-transform:uppercase;" id="vis-top1-nome">-</h2>
                        <div style="margin-top:10px; font-size:12pt; font-weight:bold; color:#27ae60;">AFINIDADE: <span id="vis-top1-nota">-</span>%</div>
                    </div>
                </div>

                <div id="m2-content"></div>

                <div class="box-conclusao">
                    <span class="bc-tit">DIRETRIZ PROJETUAL (M√ìDULO 2)</span>
                    <span id="m2-conclusao-dinamica">
                        A prefer√™ncia est√©tica n√£o √© apenas "gosto", √© a linguagem visual que o c√©rebro decodifica com facilidade.
                        Utilize o estilo predominante como base estrutural e os secund√°rios para camadas de decora√ß√£o.
                    </span>
                </div>
                <div class="ft-note">NeuroBriefing Intelligence</div>
            </div>
        </div>

        <div class="page">
            <div class="mod-content">
                <div class="m-head">
                    <div><div class="mh-tit">IDENTIDADE SENSORIAL</div><div class="mh-sub">Os 8 Sentidos & Neuroarquitetura</div></div>
                    <div class="mh-meta"><div class="mh-num">03</div><span class="mh-time" id="t3-time">--:--</span></div>
                </div>
                
                <div class="sensory-grid-8" id="m3-grid-container"></div>

                <div class="box-conclusao">
                    <span class="bc-tit">CONCLUS√ÉO T√âCNICA (SISTEMA SENSORIAL)</span>
                    A arquitetura multissensorial ativa o sistema l√≠mbico (emo√ß√µes).
                    <strong>Prioridade:</strong> Identifique os pontos com pontua√ß√£o extrema (0 ou 100).
                    <br>‚Ä¢ Se <strong>Visual</strong> > 80: Cuidado com excesso de informa√ß√£o (Complexidade Visual).
                    <br>‚Ä¢ Se <strong>Auditivo</strong> < 30: O cliente precisa de isolamento ac√∫stico superior.
                    <br>‚Ä¢ Se <strong>Proprioceptivo</strong> > 70: Crie fluxos largos e p√© direito alto.
                </div>
                <div class="ft-note">NeuroBriefing Intelligence</div>
            </div>
        </div>

        <div class="page">
            <div class="mod-content">
                <div class="m-head">
                    <div><div class="mh-tit">IDENTIDADE MEM√ìRIAS</div><div class="mh-sub">Mem√≥rias Expl√≠citas & Impl√≠citas</div></div>
                    <div class="mh-meta"><div class="mh-num">04</div><span class="mh-time" id="t4-time">--:--</span></div>
                </div>
                <div class="win-box">
                    <div class="wb-head" style="background:#8e44ad;"><div class="wb-tit">MEM√ìRIA EXPL√çCITA (CONSCIENTE)</div><div class="wb-sty">O QUE ELE DIZ</div></div>
                    <div class="wb-body" id="m4-expl" style="display:flex; flex-wrap:wrap; gap:15px;"></div>
                </div>
                <div class="win-box">
                    <div class="wb-head" style="background:#2c3e50;"><div class="wb-tit">MEM√ìRIA IMPL√çCITA (INCONSCIENTE)</div><div class="wb-sty">O QUE ELE SENTE/FAZ</div></div>
                    <div class="wb-body" id="m4-impl"></div>
                </div>
                <div class="box-conclusao">
                    <span class="bc-tit">APLICA√á√ÉO PR√ÅTICA (MEM√ìRIA)</span>
                    Baseado em <strong>Endel Tulving</strong>:
                    <br>1. Crie "altares de mem√≥ria" para objetos afetivos (Epis√≥dica).
                    <br>2. Respeite o fluxo e a bagun√ßa funcional (Procedural).
                    <br>3. Use cores/cheiros como gatilhos sutis de bem-estar (Priming).
                </div>
                <div class="ft-note">NeuroBriefing Intelligence</div>
            </div>
        </div>

        <div class="page">
            <div class="mod-content">
                <div class="m-head">
                    <div><div class="mh-tit">IDENTIDADE ATUAL</div><div class="mh-sub">Estilo de Vida & Estrat√©gia</div></div>
                    <div class="mh-meta"><div class="mh-num">05</div><span class="mh-time" id="t5-time">--:--</span></div>
                </div>
                <div class="grid-2">
                    <div class="win-box col">
                        <div class="wb-head" style="background:#2980b9;"><div class="wb-tit">FASE DE VIDA</div></div>
                        <div class="wb-body"><div class="check-tags" id="m5-fase"></div></div>
                    </div>
                    <div class="win-box col">
                        <div class="wb-head" style="background:#27ae60;"><div class="wb-tit">INVESTIMENTO (BUDGET)</div></div>
                        <div class="wb-body"><div class="check-tags" id="m5-invest"></div></div>
                    </div>
                </div>
                <div class="win-box">
                    <div class="wb-head" style="background:#e67e22;"><div class="wb-tit">HOBBIES & LAZER (Behavior Settings)</div></div>
                    <div class="wb-body"><div class="check-tags" id="m5-hobbies"></div></div>
                </div>
                <div class="win-box">
                    <div class="wb-head" style="background:#34495e;"><div class="wb-tit">PERSONALIDADE & EXPECTATIVA</div></div>
                    <div class="wb-body">
                        <div style="margin-bottom:15px;"><span class="il-lbl">TRA√áOS DE PERSONALIDADE:</span><div class="check-tags" id="m5-pers"></div></div>
                        <div>
                            <span class="il-lbl">EXPECTATIVA DE MORADIA (TEMPO):</span>
                            <div class="sensory-bar" style="margin-top:5px;">
                                <span class="sb-lbl" style="width:auto; margin-right:10px;">Provis√≥rio</span>
                                <div class="sb-track"><div class="sb-fill" id="m5-tempo-bar" style="width:50%; background:#e67e22;"></div></div>
                                <span class="sb-val" style="width:auto; margin-left:10px;">Eterno</span>
                            </div>
                            <div style="text-align:center; font-size:9pt; font-weight:bold; color:#e67e22;" id="m5-tempo-val">50%</div>
                        </div>
                    </div>
                </div>
                <div class="win-box">
                    <div class="wb-head" style="background:#7f8c8d;"><div class="wb-tit">OBSERVA√á√ïES GERAIS</div></div>
                    <div class="wb-body" style="font-style:italic; color:#555;" id="m5-obs">-</div>
                </div>
                <div class="box-conclusao">
                    <span class="bc-tit">CONCLUS√ÉO (ESTRAT√âGIA)</span>
                    Baseado em <strong>Roger Barker</strong>, o design deve sustentar os comportamentos. O alinhamento do budget com a expectativa de tempo define a materialidade.
                </div>
                <div class="ft-note">NeuroBriefing Intelligence</div>
            </div>
        </div>

    </div>

    <script>
        // 1. BANCO DE DADOS TEMPERAMENTOS (M√ìDULO 1)
        const DB = {
            FOGO: { id:'FOGO', cor:'#e74c3c', class:'fogo', titulo:'Executor (Col√©rico)', energia:'A√ß√£o ¬∑ Dire√ß√£o ¬∑ Intensidade', quem:'Pessoas focadas em resultados.', perfil:'Executor', estilos:['Contempor√¢neo', 'Industrial', 'High Tech'], neuro: 'Este c√©rebro busca <strong>dopamina</strong> (recompensa r√°pida). O projeto deve ter <strong>fluxos livres</strong>, ilumina√ß√£o clara e setoriza√ß√£o eficiente.', comunicacao: 'Seja <strong>objetivo e direto</strong>. N√£o d√™ voltas. Foque em prazos e solu√ß√µes.' },
            AR: { id:'AR', cor:'#3498db', class:'ar', titulo:'Comunicador (Sangu√≠neo)', energia:'Express√£o ¬∑ Conex√£o', quem:'Pessoas soci√°veis e visuais.', perfil:'Comunicador', estilos:['Boho', 'Ecl√©tico', 'Maximalismo'], neuro: 'Busca <strong>est√≠mulos</strong>. √Åreas de conviv√™ncia e flexibilidade.', comunicacao: 'Seja <strong>entusiasta e visual</strong>. Use muitas imagens e refer√™ncias.' },
            AGUA: { id:'√ÅGUA', cor:'#2980b9', class:'agua', titulo:'Planejador (Fleum√°tico)', energia:'Acolhimento ¬∑ Calma', quem:'Pessoas diplom√°ticas.', perfil:'Planejador', estilos:['Japandi', 'Org√¢nico'], neuro: 'Busca <strong>seguran√ßa e ocitocina</strong>. Ac√∫stica e texturas.', comunicacao: 'Seja <strong>paciente</strong>. Transmita seguran√ßa.' },
            TERRA: { id:'TERRA', cor:'#27ae60', class:'terra', titulo:'Analista (Melanc√≥lico)', energia:'Estrutura ¬∑ Ordem', quem:'Pessoas met√≥dicas.', perfil:'Analista', estilos:['Cl√°ssico', 'Minimalismo'], neuro: 'Busca <strong>previsibilidade</strong>. Simetria e arm√°rios fechados.', comunicacao: 'Seja <strong>detalhista</strong>. Mostre cronogramas.' }
        };

        // 2. BANCO DE DADOS VISUAL: NOMES (M√ìDULO 2)
        const DB_VISUAL = {
            'est_contemp': 'Contempor√¢neo', 'est_ind': 'Industrial', 'est_urb': 'Moderno Urbano', 'est_tech': 'High Tech', 'est_luxo': 'Luxo Moderno',
            'est_scandi': 'Escandinavo', 'est_cont_leve': 'Contempor√¢neo Leve', 'est_boho': 'Boho Chic', 'est_japandi': 'Japandi', 'est_wabi': 'Wabi-Sabi',
            'est_organico': 'Org√¢nico', 'est_coastal': 'Coastal', 'est_natural': 'Natural Chic',
            'est_mid': 'Mid-Century', 'est_ecletico': 'Ecl√©tico', 'est_classico': 'Cl√°ssico', 'est_neoclass': 'Neocl√°ssico',
            'est_trad': 'Tradicional Contempor√¢neo', 'est_mod_eleg': 'Moderno Elegante', 'est_colonial': 'Colonial Atualizado'
        };

        // 3. BANCO DE DADOS VISUAL: DETALHES T√âCNICOS (M√ìDULO 2 - EXPANDIDO)
        const DB_VISUAL_DETAILS = {
            'est_tech': { conceito: 'Futurismo e automa√ß√£o.', materiais: 'Vidro, A√ßo, High-Gloss.', luz: 'Linear, RGB, Fria.', mobiliario: 'Design ergon√¥mico.', neuro: 'Reduz carga cognitiva pela limpeza. Automa√ß√£o gera controle.' },
            'est_scandi': { conceito: 'Hygge: Conforto e luz.', materiais: 'Madeira clara, L√£.', luz: 'Ampla, Natural, Quente.', mobiliario: 'P√©s palito, sof√°s cinza.', neuro: 'Promove calma. Madeira clara reduz press√£o arterial.' },
            'est_ind': { conceito: 'Estrutura aparente.', materiais: 'Tijolo, Concreto, Metal.', luz: 'Trilhos, Filamento.', mobiliario: 'Couro, ferro.', neuro: 'Estimula criatividade e liberdade.' },
            'est_contemp': { conceito: 'O "agora". Conforto atual.', materiais: 'Mix de texturas.', luz: 'Vers√°til, sancas.', mobiliario: 'Linhas horizontais.', neuro: 'Equil√≠brio e atualiza√ß√£o.' },
            'est_trad': { conceito: 'Conforto familiar.', materiais: 'Madeira escura, tecidos.', luz: 'Abajures, quente.', mobiliario: 'Pe√ßas robustas.', neuro: 'Evoca mem√≥rias afetivas (Raiz).' },
            'est_classico': { conceito: 'Simetria, propor√ß√£o e eleg√¢ncia atemporal.', materiais: 'M√°rmore, Boiserie, Veludo, Dourado.', luz: 'Lustres de cristal, arandelas.', mobiliario: 'Antiguidades, pe√ßas torneadas.', neuro: 'A simetria reduz o esfor√ßo cognitivo e gera prazer est√©tico.' },
            'est_japandi': { conceito: 'Funcionalidade escandinava + Rusticidade japonesa.', materiais: 'Bambu, Cer√¢mica, Madeira crua.', luz: 'Baixa, sombras intencionais (Yugen).', mobiliario: 'Baixo, linhas retas e simples.', neuro: 'Redu√ß√£o dr√°stica de ru√≠do visual para foco e paz.' },
            'est_boho': { conceito: 'Alma livre, viagens e natureza.', materiais: 'Macram√™, Rattan, Plantas, Tapetes √©tnicos.', luz: 'Cord√£o de luzes, velas, quente.', mobiliario: 'Garimpo, pe√ßas artesanais.', neuro: 'Estimula a curiosidade e a conex√£o emocional.' },
            'est_luxo': { conceito: 'Sofistica√ß√£o, brilho e exclusividade.', materiais: 'Metais nobres, M√°rmores ex√≥ticos, Espelhos.', luz: 'C√™nica, pendentes de design.', mobiliario: 'Design italiano, couro nobre.', neuro: 'Valida√ß√£o de status e conquista (Serotonina).' },
            'est_organico': { conceito: 'Fluidez e formas da natureza.', materiais: 'Madeira curva, pedra bruta, linho.', luz: 'Difusa e envolvente.', mobiliario: 'Sof√°s curvos, mesas ovais.', neuro: 'Reduz o estresse visual. Formas curvas s√£o percebidas como seguras.' },
            'default': { conceito: 'Estilo personalizado.', materiais: 'Equil√≠brio de texturas.', luz: 'Foco em camadas.', mobiliario: 'Prioridade para ergonomia.', neuro: 'Reflete a autoimagem do cliente.' }
        };

        // 4. CORRELA√á√ïES COMBINADAS (MOD 1)
        const CORRELACOES = {
            'FOGO_TERRA': { perfil: 'O CONSTRUTOR: Pragm√°tico e ambicioso.', projeto: 'Solidez e Status. Materiais nobres.', atendimento: 'Seja t√©cnico e pontual.' },
            'FOGO_AR': { perfil: 'O INOVADOR: Din√¢mico e criativo.', projeto: 'Impacto Visual ("Uau").', atendimento: 'Seja √°gil e visual.' },
            'FOGO_AGUA': { perfil: 'O PROTETOR: Intenso e emotivo.', projeto: 'Ref√∫gio Seguro e robusto.', atendimento: 'V√≠nculo emocional r√°pido.' },
            'AR_FOGO': { perfil: 'O CRIATIVO: Mente acelerada.', projeto: 'Liberdade e Cor.', atendimento: 'Brainstorming e ritmo.' },
            'AR_TERRA': { perfil: 'O DESIGNER: Bom gosto racional.', projeto: 'Est√©tica Funcional.', atendimento: 'Explique o porqu√™ est√©tico.' },
            'AR_AGUA': { perfil: 'O ANFITRI√ÉO: Social e emp√°tico.', projeto: 'Experi√™ncia Sensorial.', atendimento: 'Foque no bem-estar.' },
            'TERRA_FOGO': { perfil: 'O ESTRATEGISTA: Controlador.', projeto: 'Efici√™ncia M√°xima.', atendimento: 'Mostre controle total.' },
            'TERRA_AR': { perfil: 'O CURADOR: Culto e detalhista.', projeto: 'Galeria Habit√°vel.', atendimento: 'Demonstre cultura.' },
            'TERRA_AGUA': { perfil: 'O GUARDI√ÉO: Conservador.', projeto: 'Tradi√ß√£o e conforto.', atendimento: 'Transmita seguran√ßa.' },
            'AGUA_FOGO': { perfil: 'O INTUITIVO: Guiado pelo feeling.', projeto: 'Personalidade e alma.', atendimento: 'Conecte-se primeiro.' },
            'AGUA_AR': { perfil: 'O SONHADOR: Sens√≠vel.', projeto: 'Leveza e tons past√©is.', atendimento: 'Seja delicado.' },
            'AGUA_TERRA': { perfil: 'O ACOLHEDOR: Fam√≠lia.', projeto: 'Ninho e cozinha grande.', atendimento: 'Seja previs√≠vel.' }
        };

        const SOMBRAS = {
            'FOGO': 'Falta paci√™ncia. Manuten√ß√£o zero.',
            'AR': 'Falta foco. Evite excesso visual.',
            'TERRA': 'Falta flexibilidade. Prove a ordem.',
            'AGUA': 'Falta praticidade. Priorize uso.'
        };

        // 5. NOVA BASE DE DADOS SENSORIAL (M√ìDULO 3)
        const DB_SENSORY_STRATEGIES = {
            'vis': { title: 'VISUAL', icon: 'üëÅÔ∏è', color: 's-vis', border: 'bg-vis',
                getStrat: (val) => val > 75 ? "Alta demanda visual. Use ilumina√ß√£o em camadas e evite polui√ß√£o." : "Prefer√™ncia por simplicidade visual." 
            },
            'aud': { title: 'AUDITIVO', icon: 'üëÇ', color: 's-aud', border: 'bg-aud',
                getStrat: (val) => val < 30 ? "Alta sensibilidade. Requer isolamento ac√∫stico e tecidos." : "Tolera ru√≠dos. Pode integrar ambientes."
            },
            'olf': { title: 'OLFATIVO', icon: 'üëÉ', color: 's-olf', border: 'bg-olf',
                getStrat: (val) => val > 70 ? "Scent Design vital. Preveja difusores e ventila√ß√£o." : "Olfato neutro. Foco na ventila√ß√£o."
            },
            'tat': { title: 'T√ÅTIL', icon: '‚úã', color: 's-tat', border: 'bg-tat',
                getStrat: (val) => val > 60 ? "Necessidade de toque. Use madeira, veludo e linho." : "Prefere superf√≠cies lisas e frias (limpeza)."
            },
            'prop': { title: 'ESPACIAL', icon: 'üß≠', color: 's-prop', border: 'bg-prop',
                getStrat: (val) => val > 50 ? "Gosta de amplitude e p√© direito alto." : "Prefere 'Toca' (ambientes acolhedores)."
            },
            'gus': { title: 'GUSTATIVO', icon: 'üçΩÔ∏è', color: 's-gus', border: 'bg-gus',
                getStrat: (val) => val > 50 ? "Cozinha social. Ilha gourmet e luz quente." : "Cozinha funcional. Praticidade."
            },
            'emo': { title: 'EMOCIONAL', icon: '‚ù§Ô∏è', color: 's-emo', border: 'bg-emo',
                getStrat: (val) => "Incorpore objetos de mem√≥ria afetiva e ref√∫gio."
            },
            'cog': { title: 'COGNITIVO', icon: 'üß†', color: 's-cog', border: 'bg-cog',
                getStrat: (val) => "Minimize distra√ß√µes. Use simetria e cores neutras."
            }
        };

        // 6. INICIALIZA√á√ÉO
        let dadosAPI = [];
        async function init() {
            try {
                const req = await fetch('https://api-neurobriefing.onrender.com/api/relatorios');
                dadosAPI = await req.json();
                dadosAPI.sort((a, b) => new Date(b.data) - new Date(a.data));
                renderTable();
            } catch(e) { console.error(e); }
        }

        function checkMod(r, k){ return r && Object.keys(r).some(x=>x.startsWith(k)); }
        function formatTime(s) { s = parseInt(s); if(isNaN(s)) return "00:00"; return `${Math.floor(s/60)}:${s%60 < 10 ? '0'+(s%60) : s%60}`; }

        function renderTable() {
            const t = document.getElementById('lista'); t.innerHTML = '';
            if(dadosAPI.length === 0) { t.innerHTML = '<tr><td colspan="5">Nenhum dossi√™ encontrado.</td></tr>'; return; }
            dadosAPI.forEach((d, i) => {
                const r = d.respostas || {};
                const hasHumana = checkMod(r, 'fogo') || checkMod(r, 'ar_');
                const hasVisual = checkMod(r, 'est_');
                const hasSensorial = checkMod(r, 'vis_') || checkMod(r, 'aud_');
                const hasMemorias = checkMod(r, 'mem_');
                const hasAtual = checkMod(r, 'atu_');
                t.innerHTML += `<tr><td>${new Date(d.data).toLocaleDateString()}</td><td><span class="cli-name">${d.cliente}</span></td><td>${d.contato?.arquiteto||'-'}</td><td><div class="mod-grid"><span class="mod-tag ${hasHumana?'done':''}">Humana</span><span class="mod-tag ${hasVisual?'done':''}">Visual</span><span class="mod-tag ${hasSensorial?'done':''}">Sensorial</span><span class="mod-tag ${hasMemorias?'done':''}">Mem√≥rias</span><span class="mod-tag ${hasAtual?'done':''}">Atual</span></div></td><td style="text-align:right"><button class="btn-pdf" onclick="makePDF(${i}, this)">Gerar PDF</button></td></tr>`;
            });
        }

        // 7. GERA√á√ÉO DO PDF (PROCESSAMENTO)
        async function makePDF(index, btn) {
            try {
                const d = dadosAPI[index];
                const original = btn.innerText; btn.innerText = "Gerando..."; btn.disabled = true;
                const r = d.respostas || {};

                // CAPA
                if(document.getElementById('cp-nome')) document.getElementById('cp-nome').innerText = d.cliente || '-';
                if(document.getElementById('cp-arq')) document.getElementById('cp-arq').innerText = d.contato?.arquiteto || '-';
                if(document.getElementById('cp-data')) document.getElementById('cp-data').innerText = d.data ? new Date(d.data).toLocaleDateString() : '-';

                // --- MOD 1 ---
                let p = { FOGO:0, AR:0, AGUA:0, TERRA:0 };
                Object.keys(r).forEach(k => {
                    let v = parseInt(r[k]) || 0;
                    if(k.startsWith('fogo')) p.FOGO += v; if(k.startsWith('ar_')) p.AR += v;
                    if(k.startsWith('agua')) p.AGUA += v; if(k.startsWith('terra')) p.TERRA += v;
                });
                const sorted = [{id:'FOGO',...DB.FOGO,v:p.FOGO},{id:'AR',...DB.AR,v:p.AR},{id:'AGUA',...DB.AGUA,v:p.AGUA},{id:'TERRA',...DB.TERRA,v:p.TERRA}].sort((a,b)=>b.v-a.v);
                const dom = sorted[0]; const sec = sorted[1]; const sombra = sorted[3];

                if(document.getElementById('t1-time')) document.getElementById('t1-time').innerText = formatTime(d.tempos?.[0] || 0);
                let chartHTML = '';
                sorted.forEach(i => {
                    let pct = Math.min((i.v / 25) * 100, 100);
                    chartHTML += `<div class="cc-box"><div class="cc-top"><span class="cc-lbl c-${i.class}">${i.id}</span><span class="cc-val">${i.v}</span></div><div class="cc-bar"><div class="cc-fill bg-${i.class}" style="width:${pct}%"></div></div></div>`;
                });
                if(document.getElementById('chart-container')) document.getElementById('chart-container').innerHTML = chartHTML;
                if(document.getElementById('wb-head')) document.getElementById('wb-head').style.backgroundColor = dom.cor;
                if(document.getElementById('txt-el')) document.getElementById('txt-el').innerText = dom.id;
                if(document.getElementById('txt-tit')) document.getElementById('txt-tit').innerText = dom.titulo;
                if(document.getElementById('m1-content')) document.getElementById('m1-content').innerHTML = `<div class="info-row"><span class="il">Energia</span><span class="iv">${dom.energia}</span></div><div class="info-row"><span class="il">Perfil</span><span class="iv">${dom.quem}</span></div><div class="info-row"><span class="il">Estilos</span><span class="iv">${dom.estilos.join(', ')}</span></div>`;
                
                if(document.getElementById('m1-neuro-individual')) document.getElementById('m1-neuro-individual').innerHTML = dom.neuro;
                if(document.getElementById('m1-comunicacao-individual')) document.getElementById('m1-comunicacao-individual').innerHTML = dom.comunicacao;

                const keyComb = `${dom.id}_${sec.id}`;
                const dataComb = CORRELACOES[keyComb] || { perfil:'Misto', projeto:'Equil√≠brio', atendimento:'Adapt√°vel' };
                if(document.getElementById('m1-perfil-texto')) document.getElementById('m1-perfil-texto').innerHTML = dataComb.perfil;
                if(document.getElementById('m1-projeto-texto')) document.getElementById('m1-projeto-texto').innerHTML = dataComb.projeto;
                const txtSombra = SOMBRAS[sombra.id] || "Buscar equil√≠brio.";
                if(document.getElementById('m1-sombra-texto')) document.getElementById('m1-sombra-texto').innerHTML = `Menos Acessado: <strong>${sombra.id}</strong><br>${txtSombra}`;
                if(document.getElementById('m1-comunicacao-texto')) document.getElementById('m1-comunicacao-texto').innerHTML = dataComb.atendimento;

                // --- MOD 2 ---
                if(document.getElementById('t2-time')) document.getElementById('t2-time').innerText = formatTime(d.tempos?.[1] || 0);
                let visualScores = [];
                Object.keys(r).forEach(k => { if(k.startsWith('est_')) visualScores.push({id:k, nome:DB_VISUAL[k]||k, val:parseInt(r[k])||0}); });
                visualScores.sort((a,b)=>b.val-a.val);
                if(visualScores.length > 0) {
                    const top = visualScores[0];
                    if(document.getElementById('vis-top1-nome')) document.getElementById('vis-top1-nome').innerText = top.nome;
                    if(document.getElementById('vis-top1-nota')) document.getElementById('vis-top1-nota').innerText = top.val;
                    const det = DB_VISUAL_DETAILS[top.id] || DB_VISUAL_DETAILS['default'];
                    let richHTML = `<div class="strategy-grid"><div class="st-card highlight"><div class="st-head">üóùÔ∏è CONCEITO</div><div class="st-text">${det.conceito}</div></div><div class="st-card"><div class="st-head">üß† NEURO DICA</div><div class="st-text">${det.neuro}</div></div></div>`;
                    richHTML += `<div class="strategy-grid"><div class="st-card"><div class="st-head">üß± MATERIAIS</div><div class="st-text">${det.materiais}</div></div><div class="st-card"><div class="st-head">üí° ILUMINA√á√ÉO</div><div class="st-text">${det.luz}</div></div><div class="st-card"><div class="st-head">ü™ë MOBILI√ÅRIO</div><div class="st-text">${det.mobiliario}</div></div></div>`;
                    richHTML += `<div style="margin-top:15px; font-size:9pt; font-weight:700; color:#999;">AFINIDADES SECUND√ÅRIAS:</div>`;
                    richHTML += visualScores.slice(1,5).map(i=>`<div class="item-list"><span class="il-lbl">${i.nome}</span><span class="il-val">${i.val}%</span></div>`).join('');
                    if(document.getElementById('m2-content')) document.getElementById('m2-content').innerHTML = richHTML;
                    if(document.getElementById('m2-conclusao-dinamica')) document.getElementById('m2-conclusao-dinamica').innerText = `Perfil ${top.nome}: Foco em ${det.conceito}`;
                }

                // --- MOD 3 (SENSORIAL) ---
                if(document.getElementById('t3-time')) document.getElementById('t3-time').innerText = formatTime(d.tempos?.[2] || 0);
                const senseKeys = ['vis','aud','olf','tat','prop','gus','emo','cog'];
                let senseHTML = '';
                
                const sVals = {
                    vis: r['vis_complex'] || 50,
                    aud: r['aud_eco'] || 0,
                    olf: r['olf_sens'] || 50,
                    tat: r['tat_tex_macia'] || 50,
                    prop: r['prop_pe_dir'] || 50,
                    gus: r['gus_social'] || 50,
                    emo: 100, 
                    cog: r['cog_prod'] || 50
                };

                senseKeys.forEach(k => {
                    const info = DB_SENSORY_STRATEGIES[k];
                    const val = sVals[k] || 50; 
                    const strat = info.getStrat(val);
                    
                    senseHTML += `
                        <div class="sense-card">
                            <div class="sense-head">
                                <span class="sense-title ${info.color}"><span class="sense-icon">${info.icon}</span> ${info.title}</span>
                            </div>
                            <div class="sense-bar-container">
                                <div class="sense-bar-bg"><div class="sense-bar-fill ${info.border}" style="width:${val}%"></div></div>
                                <span class="sense-val ${info.color}">${val}%</span>
                            </div>
                            <div class="sense-strategy">${strat}</div>
                        </div>
                    `;
                });
                if(document.getElementById('m3-grid-container')) document.getElementById('m3-grid-container').innerHTML = senseHTML;

                // --- MOD 4 ---
                if(document.getElementById('t4-time')) document.getElementById('t4-time').innerText = formatTime(d.tempos?.[3] || 0);
                let explHTML = '', implHTML = '';
                Object.keys(r).forEach(k => {
                    if(k.startsWith('mem_epi') || k.startsWith('mem_sem')) {
                        if(typeof r[k] === 'string') explHTML += `<div style="width:100%; margin-bottom:8px; background:#f9f9f9; padding:5px; border-radius:4px;"><span class="il-lbl" style="color:#8e44ad">${k.split('_')[2].toUpperCase()}</span><span class="il-val" style="font-style:italic">"${r[k]}"</span></div>`;
                        else explHTML += `<div style="width:48%; margin-bottom:5px;"><span class="il-lbl">${k.split('_')[2].toUpperCase()}</span><div class="sb-track"><div class="sb-fill" style="width:${r[k]}%; background:#8e44ad"></div></div></div>`;
                    }
                    if(k.startsWith('mem_proc') || k.startsWith('mem_prim') || k.startsWith('mem_cond')) {
                        if(typeof r[k] === 'string') implHTML += `<div style="width:100%; margin-bottom:8px; background:#f9f9f9; padding:5px; border-radius:4px;"><span class="il-lbl" style="color:#2c3e50">${k.split('_')[2].toUpperCase()}</span><span class="il-val" style="font-style:italic">"${r[k]}"</span></div>`;
                        else implHTML += `<div style="width:48%; margin-bottom:5px;"><span class="il-lbl">${k.split('_')[2].toUpperCase()}</span><div class="sb-track"><div class="sb-fill" style="width:${r[k]}%; background:#2c3e50"></div></div></div>`;
                    }
                });
                if(document.getElementById('m4-expl')) document.getElementById('m4-expl').innerHTML = explHTML || 'Sem dados.';
                if(document.getElementById('m4-impl')) document.getElementById('m4-impl').innerHTML = implHTML || 'Sem dados.';

                // --- MOD 5 ---
                if(document.getElementById('t5-time')) document.getElementById('t5-time').innerText = formatTime(d.tempos?.[4] || 0);
                const makeTags = (key, elId) => {
                    const el = document.getElementById(elId); if(el) el.innerHTML = '';
                    const val = r[key];
                    if(Array.isArray(val)) val.forEach(item => el.innerHTML += `<span class="ct-item">${item}</span>`);
                    else if(val) el.innerHTML = `<span class="ct-item">${val}</span>`;
                    else el.innerHTML = '-';
                };
                makeTags('atu_fase_vida', 'm5-fase'); makeTags('atu_investimento', 'm5-invest');
                makeTags('atu_hobbies', 'm5-hobbies'); makeTags('atu_personalidade', 'm5-pers');
                const tempo = r['atu_tempo'] || 0;
                if(document.getElementById('m5-tempo-bar')) document.getElementById('m5-tempo-bar').style.width = tempo + '%';
                if(document.getElementById('m5-tempo-val')) document.getElementById('m5-tempo-val').innerText = tempo + '% (0=Curto, 100=Longo)';
                if(document.getElementById('m5-obs')) document.getElementById('m5-obs').innerText = r['atu_obs_geral'] || '-';

                // DOWNLOAD
                const el = document.getElementById('pdf-root');
                el.style.display = 'block';
                window.scrollTo(0, 0); 
                setTimeout(async () => {
                    const opt = { margin: 0, filename: `Dossie_${d.cliente}_Completo.pdf`, image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, scrollY: 0, useCORS: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
                    await html2pdf().set(opt).from(el).save();
                    el.style.display = 'none';
                    btn.innerText = original; btn.disabled = false;
                }, 1000);

            } catch (err) {
                console.error("ERRO AO GERAR PDF:", err);
                alert("Erro ao gerar PDF: " + err.message);
                btn.innerText = "Erro"; btn.disabled = false;
            }
        }

        init();
    </script>
</body>
</html>